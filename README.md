# NGA 论坛指定板块帖子抓取脚本

这是一个 Python 脚本，用于从 NGA 论坛 (bbs.nga.cn) 的特定板块抓取帖子列表和每个帖子的第一页内容。它采用 Selenium 绕过 Cloudflare 的 JavaScript 验证（"五秒盾"）来获取有效的 Cookie，然后使用 `requests` 库进行高速并发抓取，最后将结果保存为 CSV 文件。

## ✨ 功能特性

-	**混合抓取模式**: 结合 `Selenium` 和 `requests`，兼顾了反反爬能力和抓取效率。
-	**绕过JS验证**: 自动处理 NGA 的访客验证，获取可用的 Cookie 以进行后续请求。
-	**高并发抓取**: 使用 `ThreadPoolExecutor` 并发请求帖子列表和帖子内容，大大提高抓取速度。
-	**高度可配置**: 可以轻松在脚本中配置目标板块ID、要抓取的页数、并发数和代理设置。
-	**代理支持**: 支持通过 HTTP/HTTPS 代理进行访问，增强匿名性和稳定性。
-	**健壮的日期解析**: 能够处理 NGA 的多种日期格式（如 "YYYY-MM-DD", "昨天 HH:MM", "HH:MM"）。
-	**数据持久化**: 将抓取到的所有数据（帖子标题、作者、发布时间、回复数、链接、正文）保存到 CSV 文件中，方便后续分析。

## ⚙️ 环境准备

1.  **安装 Python 3**: 请确保你的系统已安装 Python 3.x 版本。
2.  **安装 Google Chrome**: 脚本需要与 Chrome 浏览器配合使用 `ChromeDriver`。
3.  **安装依赖库**: 在终端或命令行中运行以下命令来安装所有必需的 Python 库。
    ```bash
    pip install requests beautifulsoup4 pandas selenium webdriver-manager
    ```

## 📝 配置说明

在运行脚本前，你可以在脚本文件开头的"配置区"修改以下参数：

-	`FID`: 目标板块的 ID。你可以在浏览器中打开 NGA 相应板块，URL 中的 `fid` 参数就是它的 ID。
-	`BOARD_PAGES_TO_SCRAPE`: 要从板块列表抓取的总页数。
-	`MAX_WORKERS`: 并发请求的线程数。可以根据你的网络情况和机器性能适当调整。
-	`USE_PROXY`: 是否启用代理，设置为 `True` 或 `False`。
-	`PROXY_URL`: 如果启用代理，这里是你的代理服务器地址和端口，例如 `'http://127.0.0.1:7897'`。

## 🚀 如何使用

1.  完成 **[环境准备](#⚙️-环境准备)** 和 **[配置说明](#📝-配置说明)**。
2.  在终端中进入脚本所在的目录。
3.  运行脚本：
    ```bash
    python a.py
    ```
4.  脚本会先自动启动一个无头浏览器来获取 Cookie，这个过程可能需要几十秒。
5.  获取到 Cookie 后，程序会开始在终端中输出抓取进度。请耐心等待执行完毕。

## 📊 输出说明

脚本运行结束后，会在同目录下生成一个名为 `nga_zzz_threads_data.csv` 的文件。

该文件包含以下列：

-	`tid`: 帖子 ID
-	`title`: 帖子标题
-	`author`: 作者
-	`post_time`: 发布时间
-	`replies`: 回复数
-	`url`: 帖子链接
-	`content`: 帖子第一页的所有楼层的文本内容

## ⚠️ 注意事项

-	本脚本仅供学习和技术研究使用，请勿用于任何商业或非法用途。